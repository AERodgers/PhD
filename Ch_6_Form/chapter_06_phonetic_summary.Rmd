---
title: "LMM Analysis of PNs"
author: "Antoin Rodgers"
date: "18.05.2022"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```


```{r message=FALSE, warning=FALSE, include=FALSE}
# Get personal functions and install / load necessary packages.
source("../functions/myFunctions.R")

installMissingPackages(
  c(
    # Include packages for tidy output.
    "tidyverse",
    "broomExtra",
    "sjPlot",
    "formattable",
    "knitr",
    
    # Include packages for %in% %notin% syntactic notation
    "mefa4"
  )
)

# Get data frames for AH analysis
source("scripts/get_AH_corpora.R")

  # Convert f0 values to z-scores
  pn_ana <- pn_ana %>%
  mutate(l_f0 = (l_f0 - f0_mean) / f0_SD,
         h_f0 = (h_f0 - f0_mean) / f0_SD,
         # redo excursion based on z-scores
         f0_exc = h_f0 - l_f0
         ) %>% 
  select(-f0_mean, -f0_SD)
  
  pn_foot <- pn_foot %>%
  mutate(l_f0 = (l_f0 - f0_mean) / f0_SD,
         h_f0 = (h_f0 - f0_mean) / f0_SD,
         # redo excursion based on z-scores
         f0_exc = h_f0 - l_f0
         ) %>% 
  select(-f0_mean, -f0_SD)



# Set themes and colour schemes.
theme_set(theme_minimal(base_size = 14))

rm(pn, corpus, nuc)
rm(nuc_foot, nuc_pre, pn_lex)
```


```{r message=FALSE, warning=FALSE, include=FALSE}
# Summarise continuous PN data: parameter means per speaker per condition.
pn_foot_param_sum <- param_summary(pn_foot, foot_syls, acc_phon)
pn_ana_param_sum <- param_summary(pn_ana, ana_syls, acc_phon)
```

```{r message=FALSE, warning=FALSE, include=FALSE}
#get summary of each target parameter per pa per foot_syl condition
l_t_means <-
  param_means(pn_foot_param_sum, l_t, foot_syls, acc_phon) %>%
  write_csv("output/pn_foot_l_t_means.csv")
h_t_means <-
  param_means(pn_foot_param_sum, h_t, foot_syls, acc_phon) %>%
  write_csv("output/pn_foot_h_t_means.csv")
l_f0_means <-
  param_means(pn_foot_param_sum, l_f0, foot_syls, acc_phon) %>%
  write_csv("output/pn_foot_l_f0_means.csv")
h_f0_means <-
  param_means(pn_foot_param_sum, h_f0, foot_syls, acc_phon) %>%
  write_csv("output/pn_foot_h_f0_means.csv")
lh_dur_means <-
  param_means(pn_foot_param_sum, lh_dur, foot_syls, acc_phon) %>%
  write_csv("output/pn_foot_lh_dur_means.csv")
f0_exc_means <-
  param_means(pn_foot_param_sum, f0_exc, foot_syls, acc_phon) %>%
  write_csv("output/pn_foot_f0_exc_means.csv")
slope_means <-
  param_means(pn_foot_param_sum, slope, foot_syls, acc_phon) %>%
  write_csv("output/pn_foot_slope_means.csv")
```

```{r message=FALSE, warning=FALSE, include=FALSE}
#get summary of each target parameter per pa per foot_syl condition
l_t_means <-
  param_means(pn_ana_param_sum, l_t, ana_syls, acc_phon) %>%
  write_csv("output/pn_ana_l_t_means.csv")
h_t_means <-
  param_means(pn_ana_param_sum, h_t, ana_syls, acc_phon) %>%
  write_csv("output/pn_ana_h_t_means.csv")
l_f0_means <-
  param_means(pn_ana_param_sum, l_f0, ana_syls, acc_phon) %>%
  write_csv("output/pn_ana_l_f0_means.csv")
h_f0_means <-
  param_means(pn_ana_param_sum, h_f0, ana_syls, acc_phon) %>%
  write_csv("output/pn_ana_h_f0_means.csv")
lh_dur_means <-
  param_means(pn_ana_param_sum, lh_dur, ana_syls, acc_phon) %>%
  write_csv("output/pn_ana_lh_dur_means.csv")
f0_exc_means <-
  param_means(pn_ana_param_sum, f0_exc, ana_syls, acc_phon) %>%
  write_csv("output/pn_ana_f0_exc_means.csv")
slope_means <-
  param_means(pn_ana_param_sum, slope, ana_syls, acc_phon) %>%
  write_csv("output/pn_ana_slope_means.csv")
```
